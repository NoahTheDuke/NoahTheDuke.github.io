<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Thoughts and bits: Mild success!</title>
        
<meta name="keywords" content="cohost mirror,programming,rust,splint,clojure">

<meta name="description" content="@noahtheduke posted:I dream of moving to a language like Rust or Zig, one that pursues pure speed and efficiency, but I know Clojure and I‚Äôm intimately familiar with it, so it would be quite a loss of effort and time to just get back to where I am currently.And for what? My linter runs fast enough! It can lint 120k lines of Clojure in 15 seconds. Is that Ruff speeds? No but it‚Äôs pretty dang good.Buuuuut it could be faster, and that gnaws at me lol">

<meta property="og:description" content="@noahtheduke posted:I dream of moving to a language like Rust or Zig, one that pursues pure speed and efficiency, but I know Clojure and I‚Äôm intimately familiar with it, so it would be quite a loss of effort and time to just get back to where I am currently.And for what? My linter runs fast enough! It can lint 120k lines of Clojure in 15 seconds. Is that Ruff speeds? No but it‚Äôs pretty dang good.Buuuuut it could be faster, and that gnaws at me lol">

<meta property="og:url" content="https://noahtheduke.github.io/posts/2400662-mild-success/" />
<meta property="og:title" content="Mild success!" />
<meta property="og:type" content="article" />

        <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">

        <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700|Oxygen:300,400,700|Inconsolata" rel="stylesheet">
        <link href="/css/normalize.css" rel="stylesheet" type="text/css" />
        <link href="/css/blog.css" rel="stylesheet" type="text/css" />
        <link href="/css/colors/colorful.css" rel="stylesheet" type="text/css" />
    </head>
    <body>
        <aside id="sidebar">
            <div id="logo">
                <a title="Thoughts and bits" href="/">
                    <img class="icon" src="/img/profile.webp">
                    <div class="text desktop-and-tablet-only">Thoughts and bits</div>
                    <div class="text mobile-only">Thoughts and bits</div>
                </a>
            </div>

            <nav id="sidebar-links">
                <nav id="menucont">
                    <input type="checkbox" id="menu-checkbox" class="menu-checkbox">
                    <label for="menu-checkbox" class="menutitle">
                        <svg class="icon icon-menu" aria-hidden="true"><use xlink:href="/img/icons.svg#icon-menu"></use></svg><span class="menu-text">Menu</span>
                    </label>
                    <ul class="menu">
                        <li >
                            <a title="Home" href="/">
                                <div class="menu-item-text">Home</div>
                            </a>
                        </li>
                        <li >
                            <a title="Posts" href="/p/1/">
                                <div class=" menu-item-text">Posts</div>
                            </a>
                        </li>
                        
                        <li >
                            <a href="/cohost-archive/">
                                <div class="menu-item-text">Cohost Archive</div>
                            </a>
                        </li>
                        
                        <li >
                            <a href="/now/">
                                <div class="menu-item-text">Now</div>
                            </a>
                        </li>
                        
                        <li >
                            <a title="Archives" href="/archives/">
                                <div class="menu-item-text">Archives</div>
                            </a>
                        </li>
                        
                        <li >
                            <a title="Tags" href="/tags/">
                                <div class="menu-item-text">Tags</div>
                            </a>
                        </li>
                        
                        <li>
                            <a class="menu-item-img" href="https://mykocalico.neocities.org/buttons">
                                 <img src="/img/i-was-on-cohost.gif">
                            </a>
                        </li>
                    </ul>
                </nav>

                <nav id="socialmedia">
                    <ul>
                        <li>
                            <a title="Email"
                               href="mailto:noah.bogart@hey.com"
                               target="_blank"
                               rel="external"
                               >
                               <svg class="icon icon-mail-alt">
                                   <use xlink:href="/img/icons.svg#icon-mail-alt"></use>
                               </svg>
                            </a>
                        </li>
                        <li>
                            <a title="LinkedIn"
                               href="https://www.linkedin.com/in/noah-bogart"
                               target="_blank"
                               rel="external"
                               >
                                <svg class="icon icon-linkedin">
                                    <use xlink:href="/img/icons.svg#icon-linkedin"></use>
                                </svg>
                            </a>
                        </li>
                        <li>
                            <a title="GitHub"
                               href="https://github.com/NoahTheDuke"
                               target="_blank"
                               rel="external"
                               >
                               <svg class="icon icon-github-circled">
                                   <use xlink:href="/img/icons.svg#icon-github-circled"></use>
                               </svg>
                            </a>
                        </li>
                        <li>
                            <a title="RSS Feed"
                               href="/feed.xml"
                               >
                               <svg class="icon icon-rss-squared">
                                   <use xlink:href="/img/icons.svg#icon-rss-squared"></use>
                               </svg>
                            </a>
                        </li>
                    </ul>
                </nav>
            </nav>
        </aside>

        <article id="main">
            
<div id="post">
    <div class="post-header">
    <h1>Mild success!</h1>
    <div class="byline">
        <span title="Mon, August 7, 2023, 18:14 PM">
            Aug 7, 2023, @968.06
        </span>
        / 
            
            <a href="/tags/cohost%20mirror/">#cohost mirror</a>
            
            <a href="/tags/programming/">#programming</a>
            
            <a href="/tags/rust/">#rust</a>
            
            <a href="/tags/splint/">#splint</a>
            
            <a href="/tags/clojure/">#clojure</a>
            
        
        
        / <a href="https://cohost.org/noahtheduke/post/2400662-mild-success">Cohost post</a>
        
    </div>
</div>
<hr>
<div>
    
    <p><strong>@noahtheduke</strong> posted:</p><div style="white-space: pre-line;">I spend a lot of time thinking about my linter‚Äôs performance, and I‚Äôve changed some of the ways I program in Clojure to support that. But it also means that I‚Äôve sacrificed some of the benefits of Clojure and I‚Äôm not always writing ‚Äúidiomatic‚Äù Clojure.
<p>I dream of moving to a language like Rust or Zig, one that pursues pure speed and efficiency, but I know Clojure and I‚Äôm intimately familiar with it, so it would be quite a loss of effort and time to just get back to where I am currently.</p><p>And for what? My linter runs fast enough! It can lint 120k lines of Clojure in 15 seconds. Is that Ruff speeds? No but it‚Äôs pretty dang good.</p><p>Buuuuut it could be faster, and that gnaws at me lol</p></div><hr /><p><strong>@noahtheduke</strong> posted:</p><div style="white-space: pre-line;">honestly, the big thing preventing me from actually trying this out is having to write a Clojure parser from scratch in whichever language I choose. Clojure's grammar is LL(1) I think, can be done with a fairly simple recursive-descent parser, but there's a bunch of small edge cases that make it kind of annoying (namespaced maps, for example), and then I have to come up with some representation of Clojure's data structures and use those everywhere.
<p>Actually, every part of this is annoying lmao</p><hr /><p>cuz right now I have a pattern-matching macro that takes in Clojure forms and spits out "efficient" functions that perform the matches and bind variables, so I can just write <code>(defrule lint/if-not-both "docstring" {:pattern '(if (not ?x) ?y ?z) :message "Use</code>if-not<code>instead of recreating it." :replace '(if-not ?x ?y ?z)}</code> and the <code>defrule</code> macro will transform the <code>:pattern</code> into the efficient matching and binding function and <code>:replace</code> will transform into the efficient substitution function, and the mechanics inside are all just clojure functions saying stuff like <code>(if (map? form) ...)</code>.</p><p>To do this in Rust, for example, I'd have to write a pattern-matching function (def not a macro, fuck rust macros) that takes a string and parses it, and once we're using strings, so much of the niceties of the macro are lost. Maybe there's stuff to be gained, but really how much?</p><p>I'm somewhere between talking myself completely out of this and also thinking through it hard enough I want to try. üòë</p><p>ANNOYING</p></div><hr /><p><strong>@noahtheduke</strong> posted:</p><div style="white-space: pre-line;">Not 400 beats after writing that, while watching old episodes of Bob‚Äôs Burgers with my wife, I decided to try.
<p>I updated my rust tool chain to latest, <code>cargo new clojure</code>, <code>nvim src/main.rs</code>, and then sat in wonder and astonishment and total silence for 20 minutes as I pondered how fundamentally I don‚Äôt know Rust.</p><p>I had this vague feeling that because I‚Äôd written a handful of small programs over the last 7 years and done two years of Advent of Code in Rust, I could just dive in, same as how I dive into new Clojure projects.</p><p>That is incorrect. I have completely forgotten everything I once knew about Rust lmao.</p><p>Use it or lose it, as the saying goes!</p></div><hr /><p><strong>@noahtheduke</strong> posted:</p><p>I have spent every evening over the last week and a bit working on the parser, because a parser is a very good place to start when linting code.</p><p>My code is bad, I don't know why it works after not working in many other different configurations, the whole <code>mut</code> thing is magical and kind of dumb, but I have achieved some measure of victory!</p><h3 id="i-can-parse-clojurecoreclj-8k-lines-in-12-ms">I can parse <code>clojure/core.clj</code> (8k lines) in 12 ms!</h3><p>This is roughly 5x faster than <a href="https://github.com/borkdude/edamame">edamame</a>, the parser I'm using in Splint at the moment, and 6x faster than edamame with my additions (parsing ns-forms to auto-resolve <code>::</code> keywords or parsing <code>defn</code> forms to make linting easier). I suspect that even with the additions, I'll still be 3-5x faster.</p><p>That's fuckin sick. I feel fuckin sick for pulling this off. Now I'm done, right?</p><p>meme below the fold</p><hr /><p>me irl:</p><p><img src="https://i.imgflip.com/3wh0d7.jpg" alt="Fancy &quot;The&quot; written by Spongebob with empty page" /></p>
</div>
<hr>
<div>
    Liked the post? Hated the post? Felt nothing whatsoever about the post?

    <a href="mailto:noah.bogart+blogcomment@hey.com?subject=RE: Mild success!">Email me</a>, and let me know!
</div>

    <br>
    
    <div id="prev-next">
    
    <div class="prev"></div>
    
    
    <div class="next"></div>
    
</div>

    
</div>

            <hr/>
            <div id="footercont">
                Copyright &copy; 2024 Noah Bogart
                <br>Powered by <a href="http://cryogenweb.org">Cryogen</a>
                <br>Theme by <a href="http://github.com/KingMob">KingMob</a>
            </div>
        </article>

        
        
    </body>
</html>
